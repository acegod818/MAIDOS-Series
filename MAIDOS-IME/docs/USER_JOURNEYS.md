# MAIDOS-IME v2.0 - User Journeys

## 1. Purpose

This document describes the primary user journeys for MAIDOS-IME, mapping how users
interact with each major feature from intent through completion.

## 2. Journeys

### J-001: Switch Input Scheme

- **Actor**: Any user.
- **Trigger**: User presses Ctrl+Shift+Space or clicks the scheme selector in the system tray.
- **Steps**:
  1. Current composition buffer is committed or discarded.
  2. Scheme selector popup appears listing available schemes.
  3. User selects target scheme (e.g., Bopomofo to Pinyin).
  4. Status bar updates to reflect the active scheme.
- **Outcome**: All subsequent keystrokes are interpreted under the new scheme.
- **Related**: FR-001, AC-001, AC-002, AC-003.

### J-002: Type Bopomofo (Zhuyin)

- **Actor**: Traditional Chinese user.
- **Trigger**: User types phonetic keys (e.g., "ㄅㄆㄇㄈ" mapped to keyboard).
- **Steps**:
  1. Keystroke arrives via TSF; composition buffer opens.
  2. Rust engine maps key sequence to Bopomofo syllable.
  3. Candidate list appears with matching characters ranked by frequency.
  4. User selects candidate by number key or arrow+Enter.
  5. Selected character is committed to the application.
- **Outcome**: Correct Traditional Chinese character inserted.
- **Related**: FR-002, AC-004, AC-005.

### J-003: Type Pinyin

- **Actor**: Simplified Chinese user.
- **Trigger**: User types romanized pinyin (e.g., "nihao").
- **Steps**:
  1. Latin keystrokes accumulate in composition buffer.
  2. Rust engine segments input into pinyin syllables.
  3. Candidate list displays matching characters/phrases.
  4. User selects candidate.
  5. Character(s) committed to application.
- **Outcome**: Correct Simplified Chinese character(s) inserted.
- **Related**: FR-003, AC-006, AC-007.

### J-004: Convert Traditional to Simplified (or Reverse)

- **Actor**: Bilingual Chinese user.
- **Trigger**: User selects text and presses Ctrl+Shift+T.
- **Steps**:
  1. Selected text is captured from the application via TSF.
  2. Rust engine performs character-level mapping using conversion table.
  3. Converted text replaces the selection.
- **Outcome**: Text converted between Traditional and Simplified Chinese.
- **Related**: FR-004, AC-008, AC-009.

### J-005: English Prefix Completion

- **Actor**: Any user in English scheme.
- **Trigger**: User types English letters.
- **Steps**:
  1. Keystrokes accumulate in composition buffer.
  2. Rust engine performs prefix lookup against English dictionary.
  3. Suggestion list appears with top completions.
  4. User accepts suggestion with Tab or continues typing.
- **Outcome**: English word completed efficiently.
- **Related**: FR-005, AC-010, AC-011.

### J-006: Japanese Romaji Input

- **Actor**: Japanese-speaking user.
- **Trigger**: User types romaji (e.g., "konnichiwa").
- **Steps**:
  1. Romaji keystrokes accumulate in composition buffer.
  2. Rust engine converts romaji to hiragana in real time.
  3. Space key triggers kanji candidate lookup.
  4. User selects desired kanji/katakana candidate.
  5. Selected text committed to application.
- **Outcome**: Correct Japanese text inserted.
- **Related**: FR-006, AC-012, AC-013.

### J-007: AI-Assisted Candidate Selection

- **Actor**: Any user with Ollama running locally.
- **Trigger**: Ambiguous candidate list (multiple high-frequency matches).
- **Steps**:
  1. Standard candidate list is generated by Rust engine.
  2. Engine sends surrounding context + candidates to Ollama (localhost).
  3. LLM re-ranks candidates based on contextual relevance.
  4. Updated candidate list is displayed (AI-preferred candidate marked).
  5. If Ollama is unreachable or times out (>2 s), original ranking is used.
- **Outcome**: More contextually appropriate candidate is promoted.
- **Related**: FR-007, AC-014, AC-015, AC-016, AC-017.

## 3. Journey-to-FR Traceability

| Journey | FR | AC |
|---------|----|----|
| J-001 | FR-001 | AC-001, AC-002, AC-003 |
| J-002 | FR-002 | AC-004, AC-005 |
| J-003 | FR-003 | AC-006, AC-007 |
| J-004 | FR-004 | AC-008, AC-009 |
| J-005 | FR-005 | AC-010, AC-011 |
| J-006 | FR-006 | AC-012, AC-013 |
| J-007 | FR-007 | AC-014, AC-015, AC-016, AC-017 |

# MAIDOS-Forge 整合測試方案

## 測試目標

本測試方案旨在驗證MAIDOS-Forge系統的完整功能，包括：
1. 配置解析和驗證
2. 依賴分析和排程
3. 多語言編譯和鏈接
4. 插件系統功能
5. 交叉編譯功能
6. 錯誤處理和恢復

## 測試環境

### 硬件要求
- 至少4GB RAM
- 至少10GB可用磁盤空間

### 軟件要求
- Windows 10/11, Linux (Ubuntu 20.04+), 或 macOS (11+)
- .NET 8 SDK
- 各語言編譯器（dotnet, cargo, gcc, clang等）

## 測試用例

### TC001: 基本項目創建和構建

**目標**: 驗證基本項目的創建和構建流程

**前置條件**: 
- Forge已正確安裝
- 系統PATH中包含必要的編譯器

**步驟**:
1. 執行 `forge init test-project`
2. 進入項目目錄
3. 執行 `forge build`
4. 驗證輸出文件是否存在

**預期結果**:
- 項目目錄成功創建
- 項目成功構建
- 輸出文件在預期位置生成

### TC002: 多語言模組依賴

**目標**: 驗證多語言模組間的依賴關係處理

**前置條件**: 
- TC001項目結構
- 包含C#和Rust模組

**步驟**:
1. 修改C#模組以依賴Rust模組
2. 執行 `forge build`
3. 驗證構建順序和接口生成

**預期結果**:
- 模組按正確順序編譯
- 膠水代碼正確生成
- 最終產物成功鏈接

### TC003: 插件安裝和使用

**目標**: 驗證插件系統的基本功能

**前置條件**: 
- Forge正常運行
- 網絡連接可用

**步驟**:
1. 執行 `forge plugin list`
2. 安裝一個額外語言插件
3. 創建使用該語言的模組
4. 構建項目

**預期結果**:
- 插件列表正確顯示
- 插件成功安裝
- 新語言模組正確編譯

### TC004: 交叉編譯

**目標**: 驗證交叉編譯功能

**前置條件**: 
- Forge支持交叉編譯
- 目標平台工具鏈已安裝

**步驟**:
1. 執行 `forge build --target linux-arm64`
2. 驗證產物架構
3. 在目標平台上測試產物

**預期結果**:
- 成功生成目標平台產物
- 產物在目標平台上正常運行

### TC005: 錯誤處理

**目標**: 驗證錯誤情況下的處理

**前置條件**: 
- 包含錯誤配置的項目

**步驟**:
1. 創建帶有循環依賴的項目
2. 執行 `forge build`
3. 修正錯誤配置
4. 再次構建

**預期結果**:
- 錯誤被正確檢測並報告
- 提供有意義的錯誤信息
- 修正後構建成功

## 測試數據

### 測試項目結構

```
test-project/
├── forge.json
├── modules/
│   ├── core/
│   │   ├── module.json
│   │   └── src/
│   │       ├── Core.csproj
│   │       └── Program.cs
│   ├── crypto/
│   │   ├── module.json
│   │   └── src/
│   │       ├── Cargo.toml
│   │       └── lib.rs
│   ├── utils/
│   │   ├── module.json
│   │   └── src/
│   │       ├── main.c
│   │       └── helper.h
│   └── scripts/
│       ├── module.json
│       └── src/
│           └── script.py
```

### 配置文件樣本

**forge.json**:
```json
{
  "name": "test-project",
  "version": "1.0.0",
  "description": "Integration test project",
  "authors": ["Test User"],
  "output": {
    "name": "test-app",
    "type": "executable"
  },
  "target": {
    "platform": "native",
    "architecture": "native"
  },
  "modules": [
    "core",
    "crypto",
    "utils",
    "scripts"
  ]
}
```

## 測試工具

### 自動化測試腳本

將創建一系列腳本來自動執行上述測試用例：

1. `setup-test-env.sh` - 設置測試環境
2. `run-basic-tests.sh` - 執行基本功能測試
3. `run-cross-compile-tests.sh` - 執行交叉編譯測試
4. `run-plugin-tests.sh` - 執行插件系統測試
5. `cleanup-test-env.sh` - 清理測試環境

### 測試報告

測試執行後將生成詳細報告，包括：
- 測試用例執行結果
- 性能指標
- 錯誤日誌
- 建議改進

## 測試頻率

### 開發階段
- 每次提交前執行基本功能測試
- 每日執行完整測試套件

### 發布階段
- 發布前執行所有測試用例
- 在多個平台環境中驗證

## 測試通過標準

### 功能測試
- 所有測試用例通過率≥95%
- 關鍵功能測試通過率100%

### 性能測試
- 構建時間不超過基線的120%
- 內存使用不超過系統限制

### 穩定性測試
- 連續運行24小時無崩潰
- 錯誤處理機制正常工作

## 測試維護

### 測試用例更新
- 當功能變更時及時更新相應用例
- 定期審查測試用例的有效性

### 測試環境維護
- 定期更新測試環境鏡像
- 保持編譯器和工具鏈最新

## 風險和緩解

### 主要風險
1. 編譯器版本不兼容
2. 網絡問題影響插件下載
3. 硬件資源不足

### 緩解措施
1. 維護兼容性矩陣
2. 提供離線插件安裝選項
3. 動態調整測試並行度